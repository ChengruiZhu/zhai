The mechanisms behind the most common arrhythmia, atrial fibrillation (AF), remain unclear and anti-arrhythmic drug therapy is often ineffective. In this paper, we develop and apply a novel comprehensive 3D model of canine atria to investigate the role of atrial heterogeneity in the mechanisms of AF and anti-arrhythmic drug action. We find that regions of high heterogeneity of action potential duration (APD) throughout the atria typically provide substrate for arrhythmogenic re-entrant waves during both AF initiation and progression. These mechanistic insights are directly linked with the efficacy of two clinically used class III anti-arrhythmic drugs: amiodarone is more effective at terminating AF than vernakalant, because it leads to an increase in atrial APD without increasing its dispersion. Our computational results are consistent with clinical observations and can help explain the superior efficacy of amiodarone in the clinical treatment of AF at late stages. This framework can easily be extended to investigate the action of other anti-arrhythmic drugs and translated to the human atria. By incorporating patient-specific anatomical and electrophysiological information, and after undergoing careful validation, the proposed 