It is well known that HIV can evolve to become drug resistant if it acquires specific drug-resistance mutations, but the underlying population genetic processes are not well understood. We found that the evolution of drug resistance in HIV populations within infected patients occurs by one mutation at a time (as opposed to multiple mutations simultaneously) and involves both hard and soft sweeps. In a hard sweep, a mutation originates in a single viral particle and then spreads to the entire viral population within the patient. As this mutation increases in frequency, other mutations linked to it hitchhike to high frequencies, which greatly reduces genetic diversity in the population. In a soft sweep, on the other hand, the same resistance mutation originates multiple times on different genetic backgrounds, and hitchhiking may have very little or no effect on diversity. The fact that drug resistance evolves by means of both hard and soft sweeps implies that the HIV populations are limited by the supply of resistance mutations. Using the frequency of hard and soft sweeps we obtain a point estimate of 150,000 for the effective population size of the virus, a number that is much higher than estimates based on diversity at neutral (synonymous) sites, but much lower than the actual number of HIV infected cells in a human patient.