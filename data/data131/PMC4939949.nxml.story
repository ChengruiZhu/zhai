Accurate analysis of microbial metabolism and function from metagenome and metatranscriptome data sets relies heavily on the comprehensive identification of protein family homologs present in these data. The task is routinely being done through alignment of the individual reads against the profile hidden Markov Models (HMM) of protein families in the reference database. This strategy, however, is hindered by the fact that the reads usually only represent partial protein sequences, which contain insufficient information for their accurate classification. To tackle this problem, we present a targeted assembly algorithm that, based on the sequence overlap information, simultaneously reconstructs complete or near-complete protein sequences and estimates their homology given the HMMs of the protein families of interest. The reconstructed protein sequences contain more complete information regarding the function of the corresponding protein, thus facilitating accurate annotation of themselves as well as the constituent sequencing reads. The resulting program, HMM-GRASPx, has been shown to have significantly improved performance (>40% higher recall rate with a similar level of precision rate) over other state-of-the-art counterparts such as RPS-BLAST and HMMER3.