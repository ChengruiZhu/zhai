The theory of multilevel selection (MLS) is beset with conceptual difficulties. Although it is widely agreed that covariance between group trait and group fitness may arise in the natural world and drive a response to ‘group selection’, ambiguity exists over the precise meaning of group trait and group fitness and as to whether group selection should be defined according to changes in frequencies of different types of individual or different types of group. Moreover, the theory of MLS has failed to properly engage with the problem of class structure, which greatly limits its empirical application to, for example, social insects whose colonies are structured into separate age, sex, caste and ploidy classes. Here, I develop a genetical theory of MLS, to address these problems. I show that taking a genetical approach facilitates a decomposition of group-level traits – including reproductive success – into the separate contributions made by each constituent individual, even in the context of so-called emergence. However, I uncover a novel problem with the group-oriented approach: in many scenarios, it may not be possible to express a meaningful covariance between trait and fitness at the level of the social group, because the group's constituents belong to separate, irreconcilable classes.