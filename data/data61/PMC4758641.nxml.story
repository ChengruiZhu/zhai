Exerting visual attention results in profound changes in the activity of neurons in visual areas of the brain. Attention increases the firing of some neurons, decreases that of others, moves and resizes the receptive fields of individual neurons, and changes their preferred features according to what is being attended. How are these complex, subtle effects generated? While several models explain various subsets of these effects, a consistent explanation compatible with anatomical and physiological observations remains elusive. Here we show that the apparently complex and multifaceted effects of attention on neural responses can be explained as the automatic consequence of a top-down modulation, falling on higher visual areas (as suggested by anatomical observations), and interacting with short-range inhibition and feedback connections between areas. Our model only assumes the existence of well-known features of brain organization (reciprocal inter-area connections, mutual inhibition between neighboring neurons) to explain a wide range of attentional effects, including apparently finely-tuned effects (complex shifts in feature preferences, automatic scaling of competitive effects to receptive field size, resizing or shifting of receptive fields, etc). Our model also makes novel, testable predictions about the effect of certain attentional manipulations on neural responses.