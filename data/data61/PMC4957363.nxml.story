Transformation of natural ecosystems into intensive agriculture is a main factor causing biodiversity loss worldwide. Agroforestry systems (AFS) may maintain biodiversity, ecosystem benefits and human wellbeing, they have therefore high potential for concealing production and conservation. However, promotion of intensive agriculture and disparagement of TEK endanger their permanence. A high diversity of AFS still exist in the world and their potentialities vary with the socio-ecological contexts. We analysed AFS in tropical, temperate, and arid environments, of the Tehuacan Valley, Mexico, to investigate how their capacity varies to conserve biodiversity and role of TEK influencing differences in those contexts. We hypothesized that biodiversity in AFS is related to that of forests types associated and the vigour of TEK and management. We conducted studies in a matrix of environments and human cultures in the Tehuacán Valley. In addition, we reviewed, systematized and compared information from other regions of Mexico and the world with comparable socio-ecological contexts in order to explore possible general patterns. Our study found from 26 % to nearly 90 % of wild plants species richness conserved in AFS, the decreasing proportion mainly associated to pressures for intensifying agricultural production and abandoning traditional techniques. Native species richness preserved in AFS is influenced by richness existing in the associated forests, but the main driver is how people preserve benefits of components and functions of ecosystems. Elements of modern agricultural production may coexist with traditional management patterns, but imposition of modern models may break possible balances. TEK influences decisions on what and how modern techniques may be advantageous for preserving biodiversity, ecosystem integrity in AFS and people’s wellbeing. TEK, agroecology and other sciences may interact for maintaining and improving traditional AFS to increase biodiversity and ecosystem integrity while improving quality of life of people managing the AFS.