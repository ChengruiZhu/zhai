Transcranial magnetic stimulation (TMS) is a widely applied tool for probing cognitive function in humans and is one of the best tools for clinical treatments and interfering with cognitive tasks. Surprisingly, while TMS has been commercially available for decades, the cellular mechanisms underlying magnetic stimulation remain unclear. Here we investigate these mechanisms using compartmental modeling. We generated a numerical scheme allowing simulation of the physiological response to magnetic stimulation of neurons with arbitrary morphologies and active properties. Computational experiments using this scheme suggested that TMS affects neurons in the central nervous system (CNS) primarily by somatic stimulation. Since magnetic stimulation appears to cause somatic depolarization, its effects are highly correlated with the neuron's current threshold. Our simulations therefore predict that subpopulations of CNS neurons with different firing thresholds will respond differently to magnetic stimulation. For example, low-intensity TMS may be used to stimulate low-threshold cortical inhibitory interneurons. At higher intensities we predict that both inhibitory and excitatory neurons are activated. These predictions may be tested at the cellular level and may impact cognitive experiments in humans. Furthermore, our simulations may be used to design TMS coils, devices and protocols.